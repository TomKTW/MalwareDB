<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
<title th:text="#{app.title}"></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link type="text/css" th:href="@{/css/style.css}" rel="stylesheet" />
</head>
<body>
	<header th:replace="fragment :: header"></header>
	<div th:replace="fragment :: message"></div>
	<article>
		<h2 id='malware_name' th:utext="${malware.name}"></h2>
		<div id="malware_details">
			<p id='malware_alias' th:if="${!malware.aliases.isEmpty()}"
				th:text="#{malware.aliases}+': '+${malware.getAliasesToString()}"></p>
			<p id='malware_type' th:if="${!malware.type.isEmpty()}"
				th:text="#{malware.type}+': '+${malware.type}"></p>
			<p id='malware_author' th:if="${!malware.author.isEmpty()}"
				th:text="#{malware.author}+': '+${malware.author}"></p>
			<p id='malware_date_discovery' th:if="${malware.dateDiscovery}"
				th:text="#{malware.date_discovery}+': '+${malware.dateDiscovery}"></p>
			<p id='malware_origin' th:if="${!malware.origin.isEmpty()}"
				th:text="#{malware.origin}+': '+${malware.origin}"></p>
			<p id='malware_source_language'	th:if="${!malware.sourceLanguage.isEmpty()}"
				th:text="#{malware.source_language}+': '+${malware.sourceLanguage}"></p>
			<p id='malware_platform' th:if="${!malware.platform.isEmpty()}"
				th:text="#{malware.platform}+': '+${malware.platform}"></p>
			<p id='malware_file_type' th:if="${!malware.fileType.isEmpty()}"
				th:text="#{malware.file_type}+': '+${malware.fileType}"></p>
			<p id='malware_size' th:if="${malware.size > 0}"
				th:text="#{malware.size}+': '+${malware.size} + ' bytes'"></p>
			<p id='malware_sample' sec:authorize="isAuthenticated()" th:if="${sample == true}" th:inline="text">
				[[#{malware.sample}]]: <a th:href="@{'/download/'+${malware.id}}">[[#{app.download}]]</a>
			</p>
			<div id='mediaContainer' th:each='media : ${malware.media}'>
				<div th:switch="${media.type}">
					<figure th:case="'image'">
						<a th:href="${media.source}" target="_blank"><img
							th:src='${media.source}' width='350px' height='200px' /></a>
						<figcaption th:utext='${media.caption}'></figcaption>
					</figure>
					<figure th:case="'embed'">
						<iframe width="350" height="200" th:src="${media.source}" frameborder="0"></iframe>
						<figcaption th:utext='${media.caption}'></figcaption>
					</figure>
					<figure th:case="'link'">
						<a th:href="${media.source}" target="_blank" th:utext='${media.caption}'></a>
					</figure>
				</div>
			</div>
		</div>
		<div id='malware_description'>
			<p
				th:utext="${!malware.description.isEmpty() ? malware.description : 'No description available.' }"></p>
		</div>
	</article>
	<footer th:replace="fragment :: footer"></footer>
</body>
</html>