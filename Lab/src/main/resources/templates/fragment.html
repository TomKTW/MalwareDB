<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title>MalwareDB Details</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>

	<!-- Header Begin -->
	<header th:fragment="header">
		<h1 id="title" th:text="#{app.title}"></h1>
		<nav>
			<ul>
				<li>
					<a th:href="@{/}" th:text="#{app.home}"></a>
				</li>
				<li>
					<a th:href="@{/search}" th:text="#{app.search}"></a>
				</li>
				<li th:if="${session.type == 0}">
					<a th:href="@{/create}" th:text="#{app.create}"></a>
				</li>
				<li th:if="${session.type == 0 and editable == true}">
					<a th:if="${malware.id != null}" th:href="@{'/edit/'+${malware.id}}" th:text="#{app.edit}"></a>
				</li>
			</ul>
		</nav>
		<div id="loginInfoContainer" th:if="${session.login}">
			<p th:inline="text">[[#{app.login.active} + ' ' + ${session.user}]] <a href="/logout" th:text="#{app.logout}"></a></p>
		</div>
		<div id="loginInfoContainer" th:unless="${session.login}">
			<p th:inline="text">[[#{app.login.inactive}]] <a href="/login" th:text="#{app.login}"></a></p>
		</div>
	</header>
	<!-- Header End -->

	<!-- Footer Begin -->
	<footer th:fragment="footer">
		<p>Footer placeholder.</p>
	</footer>
	<!-- Footer End-->	
	
	<!-- Message Begin -->
	<div th:fragment="message" th:switch="${message_type}" th:remove="tag">
		<div th:case="1" class="info" th:if="${message_visible == true}" id="message"><p th:text="${message}"></p></div>
		<div th:case="2" class="warning" th:if="${message_visible == true}" id="message"><p th:text="${message}"></p></div>
		<div th:case="3" class="error" th:if="${message_visible == true}" id="message"><p th:text="${message}"></p></div>
		<div th:case="*" th:if="${message_visible == true}" id="message"><p th:text="${message}"></p></div>
	</div>
	<!-- Message End -->
	
	<!-- Malware List Begin -->
	<table th:fragment="malware_list" id="malware_list" border='1'>
			<tr>
				<th th:text="#{malware.name}"></th>
				<th th:text="#{malware.type}"></th>
				<th th:text="#{malware.platform}"></th>
				<th th:text="#{malware.source_language}"></th>
				<th th:text="#{malware.file_type}"></th>
				<th th:text="#{malware.size}"></th>
				<th th:text="#{malware.author}"></th>
				<th th:text="#{malware.origin}"></th>
				<th th:text="#{malware.date_discovery}"></th>
			</tr>
			<tr th:each="malware : ${malwareList}">
				<td><a th:href="@{'/details/'+${malware.id}}" th:text="${malware.name}"></a></td>
				<td th:text="${malware.type}"></td>
				<td th:text="${malware.platform}"></td>
				<td th:text="${malware.sourceLanguage}"></td>
				<td th:text="${malware.fileType}"></td>
				<td th:text="${malware.size}"></td>
				<td th:text="${malware.author}"></td>
				<td th:text="${malware.origin}"></td>
				<td th:text="${malware.dateDiscovery}"></td>
			</tr>
	</table>
	<!-- Malware List End -->
	
	<!-- Search Form Start -->
	<form th:fragment="form_search" id="form_search" action="./search">
		<p><span th:text="#{malware.name}+': '" th:remove="tag"></span><input type="text" name="name"></input></p>
		<p><span th:text="#{malware.type}+':'" th:remove="tag"></span><input type="text" name="type"></input></p>
		<p><span th:text="#{malware.platform}+':'" th:remove="tag"></span><input type="text" name="platform"></input></p>
		<p><span th:text="#{malware.source_language}+':'" th:remove="tag"></span><input type="text" name="source_language"></input></p>
		<p><span th:text="#{malware.file_type}+':'" th:remove="tag"></span><input type="text" name="file_type"></input></p>
		<br/>
		<p><span th:text="#{malware.size}+':'" th:remove="tag"></span><input type="text" name="size"></input></p>
		<p><span th:text="#{malware.author}+':'" th:remove="tag"></span><input type="text" name="author"></input></p>
		<p><span th:text="#{malware.origin}+':'" th:remove="tag"></span><input type="text" name="origin"></input></p>
		<p><span th:text="#{malware.date_discovery}+':'" th:remove="tag"></span><input type="date" name="date_discovery"></input></p>
		<input id="submit_button" type="submit" th:value="#{app.search}"></input>
	</form>
	<!-- Search Form End -->
	
	<!-- Login Form Start -->
		<form th:fragment="form_login" id="form_login" action="/auth" method="post">
			<p th:text="#{app.login.username}+':'"></p>
			<input type="text" name="username"></input>
			<p th:text="#{app.login.password}+':'"></p>
			<input type="password" name="password"></input>
			<input type="submit" th:value="#{app.login}"></input>
		</form>
	<!-- Login Form End -->
	
	<!-- Create Form Start -->
		<form th:fragment="form_create" id="form_create" action="./submit">
			<p th:text="#{malware.name}+':'"></p>
			<input type="text" name="name"></input>
			<p th:text="#{malware.type}+':'"></p>
			<input type="text" name="type"></input>
			<p th:text="#{malware.platform}+':'"></p>
			<input type="text" name="platform"></input>
			<p th:text="#{malware.source_language}+':'"></p>
			<input type="text" name="source_language"></input>
			<p th:text="#{malware.file_type}+':'"></p>
			<input type="text" name="file_type"></input>
			<p th:text="#{malware.size}+':'"></p>
			<input type="number" name="size" value="0" min="0"></input>
			<p th:text="#{malware.author}+':'"></p>
			<input type="text" name="author"></input>
			<p th:text="#{malware.origin}+':'"></p>
			<input type="text" name="origin"></input>
			<p th:text="#{malware.date_discovery}+':'"></p>
			<input type="date" name="date_discovery"></input>
			<p th:text="#{malware.description}+':'"></p>
			<textarea name="description"></textarea>
			<input type="submit" th:value="#{app.create}"></input>
		</form>
	<!-- Create Form Start -->
	
	<!-- Edit Form Start -->
		<form th:fragment="form_edit" id="form_edit" action="/edit/apply" method="post">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<p th:text="#{malware.name}+':'"></p>
			<input type="text" name="name" th:value="${malware.name}"></input>
			<p th:text="#{malware.type}+':'"></p>
			<input type="text" name="type" th:value="${malware.type}"></input>
			<p th:text="#{malware.platform}+':'"></p>
			<input type="text" name="platform" th:value="${malware.platform}"></input>
			<p th:text="#{malware.source_language}+':'"></p>
			<input type="text" name="source_language" th:value="${malware.sourceLanguage}"></input>
			<p th:text="#{malware.file_type}+':'"></p>
			<input type="text" name="file_type" th:value="${malware.fileType}"></input>
			<p th:text="#{malware.size}+':'"></p>
			<input type="number" name="size" th:value="${malware.size}" min="0"></input>
			<p th:text="#{malware.author}+':'"></p>
			<input type="text" name="author" th:value="${malware.author}"></input>
			<p th:text="#{malware.origin}+':'"></p>
			<input type="text" name="origin" th:value="${malware.origin}"></input>
			<p th:text="#{malware.date_discovery}+':'"></p>
			<input type="date" name="date_discovery" th:value="${malware.dateDiscovery}"></input>
			<p th:text="#{malware.description}+':'"></p>
			<textarea name="description" th:text="${malware.description}"></textarea>
			<input type="submit" th:value="#{app.edit}"></input>
		</form>
		<form th:fragment="form_add_alias" id="form_add_alias" action="/edit/addAlias" method="get">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<p th:text="#{malware.aliases}+':'"></p>
			<input type="text" name="alias" value=""></input>
			<input type="text" name="author" value=""></input>
			<input type="submit" th:value="#{app.add}"></input>
		</form>
		<form th:fragment="form_remove_alias" id="form_remove_alias" action="/edit/removeAlias" method="get">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<select name="alias_id">
  				<option th:each='alias : ${malware.aliases}' th:value="${alias.id}" th:text="${alias.name} + ' (' +${alias.author}+')' "></option> 
			</select>			
			<input type="submit" th:value="#{app.remove}"></input>
		</form>
		<form th:fragment="form_add_media" id="form_add_media" action="/edit/addMedia" method="get">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<p th:text="#{malware.media}+':'"></p>
			<input type="text" name="source" value=""></input>
			<input type="text" name="caption" value=""></input>
			<input type="text" name="type" value=""></input>
			<input type="submit" th:value="#{app.add}"></input>
		</form>
		<form th:fragment="form_remove_media" id="form_remove_media" action="/edit/removeMedia" method="get">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<select name="media_id">
  				<option th:each='media : ${malware.media}' th:value="${media.id}" th:text="${media.caption} + ' (' + ${media.source} + ', ' +${media.type}+')' "></option> 
			</select>			
			<input type="submit" th:value="#{app.remove}"></input>
		</form>
	<!-- Edit Form End -->	
</body>
</html>