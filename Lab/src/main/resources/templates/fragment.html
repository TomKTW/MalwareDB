<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
<title>MalwareDB Details</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>

	<!-- Header Begin -->
	<header th:fragment="header">
		<h1 id="title" th:text="#{app.title}"></h1>
		<nav>
			<ul>
				<li>
					<form th:action="@{/}" method="get">
						<input class="button" type="submit" th:value="#{app.home}" />
					</form>
				</li>
				<li>
					<form th:action="@{/search}" method="get">
						<input class="button" type="submit" th:value="#{app.search}" />
					</form>
				</li>
				<li sec:authorize="isAuthenticated()">
					<form th:action="@{/create}" method="get">
						<input class="button" type="submit" th:value="#{app.create}" />
					</form>
				</li>
				<li sec:authorize="isAuthenticated()" th:if="${editable == true}">
					<form th:action="@{'/edit/'+${malware.id}}" method="get"
						th:if="${malware.id != null}">
						<input class="button" type="submit" th:value="#{app.edit}" />
					</form>
				</li>
				<li sec:authorize="isAuthenticated()" th:if="${editable == true}">
					<form th:action="@{'/delete/'+${malware.id}}" method="get"
						th:if="${malware.id != null}">
						<input class="button" type="submit" th:value="#{app.delete}" />
					</form>
				</li>
				<li sec:authorize="hasRole('ROLE_ADMIN')">
					<form th:action="@{/admin}" method="get">
						<input class="button" type="submit" th:value="#{app.admin}" />
					</form>
				</li>
				<li>
					<form sec:authorize="isAuthenticated()" th:action="@{/logout}"
						method="post">
						<input class="button" type="submit" th:value="#{app.logout}" />
					</form>
					<form sec:authorize="!isAuthenticated()" th:action="@{/login}"
						method="get">
						<input class="button" type="submit" th:value="#{app.login}" />
					</form>
				</li>
				<li>
					<form sec:authorize="!isAuthenticated()" th:action="@{/register}"
						method="get">
						<input class="button" type="submit" th:value="#{app.register}" />
					</form>
				</li>
			</ul>
		</nav>
	</header>
	<!-- Header End -->

	<!-- Footer Begin -->
	<footer th:fragment="footer">
		<p>MalwareDB - 2016.</p>
	</footer>
	<!-- Footer End-->

	<!-- Message Begin -->
	<div th:fragment="message" th:if="${message}" id="message"
		th:class="${message_type}">
		<p th:text="${message}"></p>
	</div>
	<!-- Message End -->

	<!-- Malware List Begin -->
	<table th:fragment="malware_list" id="malware_list" border='1'>
		<tr>
			<th th:text="#{malware.name}"></th>
			<th th:text="#{malware.type}"></th>
			<th th:text="#{malware.platform}"></th>
			<th th:text="#{malware.source_language}"></th>
			<th th:text="#{malware.file_type}"></th>
			<th th:text="#{malware.size}"></th>
			<th th:text="#{malware.author}"></th>
			<th th:text="#{malware.origin}"></th>
			<th th:text="#{malware.date_discovery}"></th>
		</tr>
		<tr th:each="malware : ${malwareList}">
			<td><a th:href="@{'/details/'+${malware.id}}" 
			th:text="${!malware.name.isEmpty() ? malware.name : 'Undefined' }"></a></td>
			<td th:text="${malware.type}"></td>
			<td th:text="${malware.platform}"></td>
			<td th:text="${malware.sourceLanguage}"></td>
			<td th:text="${malware.fileType}"></td>
			<td th:text="${malware.size > 0 ? malware.size : ''}"></td>
			<td th:text="${malware.author}"></td>
			<td th:text="${malware.origin}"></td>
			<td th:text="${malware.dateDiscovery}"></td>
		</tr>
	</table>
	<!-- Malware List End -->
</body>
</html>