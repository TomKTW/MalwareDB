<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity4">
<head>
<title>MalwareDB Details</title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
</head>
<body>

	<!-- Header Begin -->
	<header th:fragment="header">
		<h1 id="title" th:text="#{app.title}"></h1>
		<nav>
			<ul>
				<li>
					<a th:href="@{/}" th:text="#{app.home}"></a>
				</li>
				<li>
					<a th:href="@{/search}" th:text="#{app.search}"></a>
				</li>
				<li sec:authorize="hasRole('ROLE_USER')">
					<a th:href="@{/create}" th:text="#{app.create}"></a>
				</li>
				<li sec:authorize="hasRole('ROLE_ADMIN')" th:if="${editable == true}">
					<a th:href="@{'/edit/'+${malware.id}}" th:text="#{app.edit}" th:if="${malware.id != null}"></a>
				</li>
			</ul>
		</nav>
		<div id="loginInfoContainer">
			<form sec:authorize="hasRole('ROLE_USER')" th:action="@{/logout}" method="post">
				<p th:inline="text">[[#{app.login.active(${#authentication.name})}]] <input type="submit" th:value="#{app.logout}"/></p>
			</form>
			<form sec:authorize="${#authentication.name == 'anonymousUser'}" th:action="@{/login}" method="get">
				<p th:inline="text">[[#{app.login.inactive}]] <input type="submit" th:value="#{app.login}"/></p>	
			</form>
		</div>
	</header>
	<!-- Header End -->

	<!-- Footer Begin -->
	<footer th:fragment="footer">
		<p>Footer placeholder.</p>
	</footer>
	<!-- Footer End-->	
	
	<!-- Message Begin -->
	<div th:fragment="message" th:if="${message}" id="message" th:class="${message_type}">
		<p th:text="${message}"></p>
	</div>
	<!-- Message End -->
	
	<!-- Malware List Begin -->
	<table th:fragment="malware_list" id="malware_list" border='1'>
			<tr>
				<th th:text="#{malware.name}"></th>
				<th th:text="#{malware.type}"></th>
				<th th:text="#{malware.platform}"></th>
				<th th:text="#{malware.source_language}"></th>
				<th th:text="#{malware.file_type}"></th>
				<th th:text="#{malware.size}"></th>
				<th th:text="#{malware.author}"></th>
				<th th:text="#{malware.origin}"></th>
				<th th:text="#{malware.date_discovery}"></th>
			</tr>
			<tr th:each="malware : ${malwareList}">
				<td><a th:href="@{'/details/'+${malware.id}}" th:text="${malware.name}"></a></td>
				<td th:text="${malware.type}"></td>
				<td th:text="${malware.platform}"></td>
				<td th:text="${malware.sourceLanguage}"></td>
				<td th:text="${malware.fileType}"></td>
				<td th:text="${malware.size}"></td>
				<td th:text="${malware.author}"></td>
				<td th:text="${malware.origin}"></td>
				<td th:text="${malware.dateDiscovery}"></td>
			</tr>
	</table>
	<!-- Malware List End -->
</body>
</html>