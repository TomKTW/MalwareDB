<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title th:text="#{app.title}"></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link type="text/css" th:href="@{/css/style.css}" rel="stylesheet" />
</head>
<body>
	<header th:replace="fragment :: header"></header>
	<div th:replace="fragment :: message"></div>
	<form th:fragment="form_edit" id="form_edit" th:action="@{/edit/apply}"
		method="post">
		<input type="hidden" name="id" th:value="${malware.id}"></input>
		<p th:text="#{malware.name}+':'"></p>
		<input type="text" name="name" th:value="${malware.name}"></input>
		<p th:text="#{malware.type}+':'"></p>
		<input type="text" name="type" th:value="${malware.type}"></input>
		<p th:text="#{malware.platform}+':'"></p>
		<input type="text" name="platform" th:value="${malware.platform}"></input>
		<p th:text="#{malware.source_language}+':'"></p>
		<input type="text" name="source_language" th:value="${malware.sourceLanguage}"></input>
		<p th:text="#{malware.file_type}+':'"></p>
		<input type="text" name="file_type" th:value="${malware.fileType}"></input>
		<p th:text="#{malware.size}+':'"></p>
		<input type="number" name="size" th:value="${malware.size}" min="0"></input>
		<p th:text="#{malware.author}+':'"></p>
		<input type="text" name="author" th:value="${malware.author}"></input>
		<p th:text="#{malware.origin}+':'"></p>
		<input type="text" name="origin" th:value="${malware.origin}"></input>
		<p th:text="#{malware.date_discovery}+':'"></p>
		<input type="date" name="date_discovery"
			th:value="${malware.dateDiscovery}"></input>
		<p th:text="#{malware.description}+':'"></p>
		<textarea name="description" th:text="${malware.description}"></textarea>
		<input type="submit" th:value="#{app.edit}"></input>
	</form>
	<form th:fragment="form_add_alias" id="form_add_alias"
		th:action="@{/edit/addAlias}" method="get">
		<input type="hidden" name="id" th:value="${malware.id}"></input>
		<p th:text="#{malware.aliases}+':'"></p>
		<input type="text" name="alias" value=""></input> <input type="text"
			name="author" value=""></input> <input type="submit"
			th:value="#{app.add}"></input>
	</form>
	<form th:fragment="form_remove_alias" id="form_remove_alias"
		th:action="@{/edit/removeAlias}" method="get">
		<input type="hidden" name="id" th:value="${malware.id}"></input> <select
			name="alias_id">
			<option th:each='alias : ${malware.aliases}' th:value="${alias.id}"
				th:text="${alias.name} + ' (' +${alias.author}+')' "></option>
		</select> <input type="submit" th:value="#{app.remove}"></input>
	</form>
	<form th:fragment="form_add_media" id="form_add_media"
		th:action="@{/edit/addMedia}" method="get">
		<input type="hidden" name="id" th:value="${malware.id}"></input>
		<p th:text="#{malware.media}+':'"></p>
		<input type="text" name="source" value=""></input> <input type="text"
			name="caption" value=""></input> <input type="text" name="type"
			value=""></input> <input type="submit" th:value="#{app.add}"></input>
	</form>
	<form th:fragment="form_remove_media" id="form_remove_media"
		th:action="@{/edit/removeMedia}" method="get">
		<input type="hidden" name="id" th:value="${malware.id}"></input> <select
			name="media_id">
			<option th:each='media : ${malware.media}' th:value="${media.id}"
				th:text="${media.caption} + ' (' + ${media.source} + ', ' +${media.type}+')' "></option>
		</select> <input type="submit" th:value="#{app.remove}"></input>
	</form>
	<footer th:replace="fragment :: footer"></footer>
</body>
</html>