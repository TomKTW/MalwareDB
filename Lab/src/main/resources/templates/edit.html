<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<title th:text="#{app.title}"></title>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<link type="text/css" th:href="@{/css/style.css}" rel="stylesheet" />
</head>
<body>
	<header th:replace="fragment :: header"></header>
	<div th:replace="fragment :: message"></div>
	<form th:fragment="form_edit" id="form_edit" th:action="@{/edit/apply}"
		method="post">
		<div id="create_form_container">
			<input type="hidden" name="id" th:value="${malware.id}"></input>
			<div id="create_def_container">
				<p th:text="#{malware.name}+':'"></p>
				<p th:text="#{malware.type}+':'"></p>
				<p th:text="#{malware.platform}+':'"></p>
				<p th:text="#{malware.source_language}+':'"></p>
				<p th:text="#{malware.file_type}+':'"></p>
				<p th:text="#{malware.size}+':'"></p>
				<p th:text="#{malware.author}+':'"></p>
				<p th:text="#{malware.origin}+':'"></p>
				<p th:text="#{malware.date_discovery}+':'"></p>
			</div>
			<div id="create_input_container">
				<input type="text" name="name" th:value="${malware.name}"></input>
				<input type="text" name="type" th:value="${malware.type}"></input>
				<input type="text" name="platform" th:value="${malware.platform}"></input>
				<input type="text" name="source_language" th:value="${malware.sourceLanguage}"></input>
				<input type="text" name="file_type" th:value="${malware.fileType}"></input>
				<input type="number" name="size" th:value="${malware.size}" min="0"></input>
				<input type="text" name="author" th:value="${malware.author}"></input>
				<input type="text" name="origin" th:value="${malware.origin}"></input>
				<input type="date" name="date_discovery"
					th:value="${malware.dateDiscovery}"></input>
			</div>
			<div id="create_description_input_container">
				<p th:text="#{malware.description}+':'"></p>
				<textarea name="description" th:text="${malware.description}"></textarea>
				<input id="submit_button" type="submit" th:value="#{app.apply}"></input>
			</div>
		</div>
	</form>
	<div class="edit_sub_form_fix_container">
		<div id="edit_alias_form_container">
			<form th:fragment="form_add_alias" id="form_add_alias"
				th:action="@{/edit/addAlias}" method="post">
				<input type="hidden" name="id" th:value="${malware.id}"></input>
				<p th:text="#{malware.aliases}+':'"></p>
				<input type="text" name="alias" th:placeholder="#{alias.name}" value=""></input>
				<input type="text" name="author" th:placeholder="#{alias.author}" value=""></input>
				<input id="submit_button" type="submit" th:value="#{app.add}"></input>
			</form>
			<form th:if="${!malware.aliases.isEmpty()}"
				th:fragment="form_remove_alias" id="form_remove_alias"
				th:action="@{/edit/removeAlias}" method="post">
				<input type="hidden" name="id" th:value="${malware.id}"></input>
				<select	name="alias_id">
					<option th:each='alias : ${malware.aliases}' th:value="${alias.id}"
					th:text="${alias.name} + ' (' +${alias.author}+')' "></option>
				</select>
				<input id="submit_button" type="submit" th:value="#{app.remove}"></input>
			</form>
		</div>
	</div>
	<div class="edit_sub_form_fix_container">
		<div id="edit_media_form_container">
			<form th:fragment="form_add_media" id="form_add_media"
				th:action="@{/edit/addMedia}" method="post">
				<input type="hidden" name="id" th:value="${malware.id}"></input>
				<p th:text="#{malware.media}+':'"></p>
				<input type="text" name="source" th:placeholder="#{media.source}" value=""></input>
				<input type="text" name="caption" th:placeholder="#{media.caption}" value=""></input>
				<select	name="type">
					<option value="image" th:text="Image"></option>
					<option value="embed" th:text="Embed"></option>
					<option value="link" th:text="Link"></option>
				</select>
				<input id="submit_button" type="submit" th:value="#{app.add}"></input>
			</form>
			<form th:if="${!malware.media.isEmpty()}"
				th:fragment="form_remove_media" id="form_remove_media"
				th:action="@{/edit/removeMedia}" method="post">
				<input type="hidden" name="id" th:value="${malware.id}"></input>
				<select	name="media_id">
					<option th:each='media : ${malware.media}' th:value="${media.id}"
					th:text="${media.caption} + ' (' + ${media.source} + ', ' +${media.type}+')' "></option>
				</select>
				<input id="submit_button" type="submit" th:value="#{app.remove}"></input>
			</form>
		</div>
	</div>
	<div class="edit_sub_form_fix_container">
		<div id="edit_upload_form_container">
			<form th:fragment="form_upload_file" method="post"
				enctype="multipart/form-data"
				th:action="@{/edit/upload(${_csrf.parameterName}=${_csrf.token})}">
				<input type="hidden" name="id" th:value="${malware.id}"></input>
				<p th:text="#{app.upload}+':'"></p>
				<input type="file" name="file" />
				<input id="submit_button" type="submit" th:value="#{app.upload}" />
			</form>
		</div>
	</div>
	<footer th:replace="fragment :: footer"></footer>
</body>
</html>