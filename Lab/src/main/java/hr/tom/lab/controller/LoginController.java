package hr.tom.lab.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.MessageSource;
import org.springframework.jdbc.core.JdbcTemplate;
import org.springframework.stereotype.Controller;
import org.springframework.ui.Model;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestParam;

import hr.tom.lab.entity.MessageConfig;
import hr.tom.lab.entity.MessageType;

/**
 * Controller class used for login page.
 * 
 * @author Tom.K
 *
 */
@Controller
public class LoginController {

	@Autowired
	JdbcTemplate jdbcTemplate;

	@Autowired
	MessageSource messageSource;

	/**
	 * Generates "login" template page.
	 * 
	 * @param model
	 *            Template model.
	 * @param logout
	 *            Parameter defined when using "/logout".
	 * @param error
	 *            Parameter defined when login data is incorrect.
	 * @return Template page "login.html".
	 */
	@RequestMapping("/login")
	public String login(Model model, @RequestParam(value = "logout", required = false) Object logout,
			@RequestParam(value = "error", required = false) Object error) {
		if (logout != null) {
			MessageConfig.setMessage(model, messageSource, "message.logout.success", MessageType.INFO);
		} else if (error != null) {
			MessageConfig.setMessage(model, messageSource, "message.login.failure", MessageType.ERROR);
		}
		return "login";
	}
}
